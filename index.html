<html>
	<head>
		<script src="qb.js"></script>
	</head>
	<body>
		<div id="main"></div>
		<div id="debug"></div>

		<script>
			var ScriptSrc = './assets/' // directory of charmap.png
			var cons = new qb.Console(document.getElementById('main'), undefined, 320, 600)
			var audio = new qb.AudioDevice()
			var virtualMachine = new qb.VirtualMachine(cons, audio)
			var dbg = new qb.DebugConsole(document.getElementById('debug'))
			fetch('helloWorld.bas')
				.then(resp => {
					if (resp.status === 200) return resp.text()
					throw new Error(404, 'Program not found.')
				})
				.then(code => {
					var program = new qb.QBasicProgram(code)
					if (program.errors.length === 0) {
						virtualMachine.run(program, false)
					} else {
						virtualMachine.reset(null)
						for (var i = 0; i < program.errors.length; i++) {
							dbg.print(program.errors[i] + '\n')
						}
						cons.enableCursor(true)
					}
				})
				.catch(e => console.error(e))
		</script>
	</body>
</html>
